import plotly.express as px
import numpy as np

"""
Check plot_v_value_2d.py for more details. But code you should use below
tmp_score=[]
for i in range(-10, 11):
    ti_score = []
    for j in range(-10, 11):
        normalized_obs_dict['obs'][0][0]=i * 0.2
        normalized_obs_dict['obs'][0][1]=j * 0.2
        x = self.forward_head(normalized_obs_dict)
        x, new_rnn_states = self.forward_core(x, rnn_states)
        result = self.forward_tail(x, values_only, sample_actions=True)
        ti_score.append(result['values'].item())            
    tmp_score.append(ti_score)
print(tmp_score)
"""

x = np.arange(-2.0, 2.1, 0.2)
y = np.arange(-2.0, 2.1, 0.2)
value = np.array([[-1.046976089477539, -0.9372676014900208, -0.834980845451355, -0.747315526008606, -0.6754142642021179, -0.6204982995986938, -0.5861996412277222, -0.5694772005081177, -0.5638792514801025, -0.5645636916160583, -0.5689689517021179, -0.5766781568527222, -0.5895943641662598, -0.6124382019042969, -0.6521246433258057, -0.7118673324584961, -0.7814335823059082, -0.8448623418807983, -0.8992334008216858, -0.9481641054153442, -0.9929596781730652], [-1.001110315322876, -0.8912216424942017, -0.7898903489112854, -0.7035033702850342, -0.6336020231246948, -0.5800396800041199, -0.5459231734275818, -0.5294400453567505, -0.5243607759475708, -0.5255995988845825, -0.5304893255233765, -0.5386357307434082, -0.5520575046539307, -0.5757855176925659, -0.6171807050704956, -0.67908775806427, -0.7503697276115417, -0.8163374662399292, -0.8733943700790405, -0.9221827983856201, -0.9648914337158203], [-0.965925395488739, -0.856200098991394, -0.7552466988563538, -0.6677525639533997, -0.5958312153816223, -0.5406490564346313, -0.5056169033050537, -0.48912134766578674, -0.48440036177635193, -0.4859941899776459, -0.49122652411460876, -0.4998341500759125, -0.5141236782073975, -0.5397152304649353, -0.5846407413482666, -0.6513938903808594, -0.727941632270813, -0.7989629507064819, -0.8578280210494995, -0.9047396779060364, -0.9450585246086121], [-0.9437981247901917, -0.8353913426399231, -0.735020101070404, -0.6454590559005737, -0.5682094097137451, -0.5068633556365967, -0.46816954016685486, -0.45107850432395935, -0.4466775357723236, -0.448301762342453, -0.45332011580467224, -0.46189138293266296, -0.47699663043022156, -0.5052996873855591, -0.555709958076477, -0.6299858093261719, -0.7139055132865906, -0.7888553142547607, -0.8466383218765259, -0.8906763792037964, -0.9293955564498901], [-0.9321250915527344, -0.8279315233230591, -0.7301548719406128, -0.6398402452468872, -0.5568625926971436, -0.48590990900993347, -0.4391673505306244, -0.4193834960460663, -0.4150422513484955, -0.41663965582847595, -0.4211500585079193, -0.4294341504573822, -0.445555180311203, -0.47743186354637146, -0.5345587730407715, -0.6169990301132202, -0.7062991261482239, -0.7808215618133545, -0.8351883292198181, -0.8767697215080261, -0.9152470827102661], [-0.9265629053115845, -0.8304659724235535, -0.73865807056427, -0.6505098342895508, -0.5639863014221191, -0.4832795560359955, -0.42511722445487976, -0.3989350497722626, -0.39315328001976013, -0.3946426808834076, -0.3989144265651703, -0.4073300063610077, -0.4251159131526947, -0.4612562358379364, -0.5250779390335083, -0.6132701635360718, -0.7024236917495728, -0.7721246480941772, -0.8222391605377197, -0.8622326850891113, -0.9015994071960449], [-0.9232174754142761, -0.838615357875824, -0.7561361193656921, -0.6733987927436829, -0.5865296125411987, -0.49853846430778503, -0.428703635931015, -0.3930003345012665, -0.3830232322216034, -0.3834511935710907, -0.38759228587150574, -0.39668580889701843, -0.4168696105480194, -0.4578286111354828, -0.5274792909622192, -0.6171200275421143, -0.7005724906921387, -0.762961208820343, -0.8086904287338257, -0.8475642204284668, -0.8883485198020935], [-0.9187061190605164, -0.8470710515975952, -0.7755028605461121, -0.6999533772468567, -0.6152247190475464, -0.5232142210006714, -0.4439748227596283, -0.3980672061443329, -0.3817845284938812, -0.3799963891506195, -0.3840617835521698, -0.3945504128932953, -0.4181308448314667, -0.4646209180355072, -0.5387508869171143, -0.625693678855896, -0.7003771066665649, -0.754810094833374, -0.7961693406105042, -0.8338682651519775, -0.8759613633155823], [-0.9099370837211609, -0.8503724336624146, -0.7890582084655762, -0.7205069065093994, -0.6388754844665527, -0.5453122854232788, -0.45945867896080017, -0.40464839339256287, -0.3818751275539398, -0.3779023587703705, -0.3829263150691986, -0.39646169543266296, -0.42514440417289734, -0.47791406512260437, -0.5546737909317017, -0.6361304521560669, -0.7015547752380371, -0.7487059831619263, -0.7860360145568848, -0.822424054145813, -0.8653624057769775], [-0.8946007490158081, -0.844650387763977, -0.7918769121170044, -0.7294962406158447, -0.6510840654373169, -0.5571215152740479, -0.4664318263530731, -0.4042663276195526, -0.37589308619499207, -0.3708593547344208, -0.3789813220500946, -0.3982878625392914, -0.4344136416912079, -0.49386510252952576, -0.5711605548858643, -0.6459023952484131, -0.7030932903289795, -0.7443174123764038, -0.7783995866775513, -0.8136984705924988, -0.8571405410766602], [-0.8724964261054993, -0.8291149735450745, -0.7827274799346924, -0.7255319952964783, -0.650039792060852, -0.555810809135437, -0.4609696567058563, -0.3924393355846405, -0.3593740165233612, -0.35463187098503113, -0.36839625239372253, -0.3967157304286957, -0.4427048861980438, -0.5086791515350342, -0.5848443508148193, -0.6530541181564331, -0.7037041187286377, -0.74048912525177, -0.7722121477127075, -0.8068337440490723, -0.8506304025650024], [-0.8474622368812561, -0.8074976801872253, -0.7646045684814453, -0.7106692790985107, -0.636985182762146, -0.5418597459793091, -0.44290849566459656, -0.3685579001903534, -0.3314175307750702, -0.3278977572917938, -0.3493361175060272, -0.38948854804039, -0.44707390666007996, -0.518964409828186, -0.5933539867401123, -0.6563674211502075, -0.7025274038314819, -0.73633873462677, -0.7664185762405396, -0.8005514144897461, -0.8443855047225952], [-0.8268623352050781, -0.7877472639083862, -0.7454277873039246, -0.6920167803764343, -0.618085503578186, -0.5207589864730835, -0.4172752797603607, -0.33730027079582214, -0.29638370871543884, -0.2942673861980438, -0.3240102231502533, -0.377157062292099, -0.4464816749095917, -0.5232994556427002, -0.5961830615997314, -0.6559625864028931, -0.6998952627182007, -0.732306957244873, -0.7613352537155151, -0.794771671295166, -0.83785080909729], [-0.8164584040641785, -0.7768016457557678, -0.7334421277046204, -0.6786558628082275, -0.6026935577392578, -0.5019258260726929, -0.3934774100780487, -0.3080500066280365, -0.26367780566215515, -0.26283368468284607, -0.30020174384117126, -0.36524030566215515, -0.44431373476982117, -0.5243933200836182, -0.5960735082626343, -0.6543233394622803, -0.6981136798858643, -0.7309390306472778, -0.759813666343689, -0.7922621965408325, -0.8333615064620972], [-0.8173725008964539, -0.776611864566803, -0.7318060398101807, -0.6752077341079712, -0.5967593193054199, -0.492302268743515, -0.3790836036205292, -0.2887987792491913, -0.24171744287014008, -0.24246035516262054, -0.2865600287914276, -0.36096176505088806, -0.446338027715683, -0.5274780988693237, -0.5977650880813599, -0.6554033756256104, -0.7005139589309692, -0.7356351613998413, -0.7660303115844727, -0.7980153560638428, -0.8362522125244141], [-0.8283698558807373, -0.7862045764923096, -0.7398931980133057, -0.6816996932029724, -0.6013109683990479, -0.4940323531627655, -0.37709471583366394, -0.28303489089012146, -0.23429666459560394, -0.23730693757534027, -0.2872428596019745, -0.3677229583263397, -0.4555412232875824, -0.535668134689331, -0.6042615175247192, -0.661778450012207, -0.7091243267059326, -0.7481067180633545, -0.7821465730667114, -0.8154342174530029, -0.8513507843017578], [-0.848362922668457, -0.8046026229858398, -0.7566651105880737, -0.6970747709274292, -0.6156056523323059, -0.5071984529495239, -0.3885587155818939, -0.2924287021160126, -0.2432609647512436, -0.24901674687862396, -0.3030448853969574, -0.3852780759334564, -0.471625417470932, -0.5491658449172974, -0.6161175966262817, -0.6741455793380737, -0.7245379686355591, -0.7685188055038452, -0.8079118728637695, -0.8446321487426758, -0.8803144693374634], [-0.8770304322242737, -0.831751823425293, -0.7820703387260437, -0.7211242914199829, -0.6393552422523499, -0.5319516658782959, -0.4146958291530609, -0.31928619742393494, -0.2712901532649994, -0.2795393168926239, -0.3341924846172333, -0.4126175343990326, -0.4936501681804657, -0.5676339864730835, -0.6336519718170166, -0.6934148073196411, -0.7480276823043823, -0.7979205846786499, -0.8434149026870728, -0.8847540616989136, -0.9227273464202881], [-0.9144989252090454, -0.8682724237442017, -0.8170230388641357, -0.7548134922981262, -0.6733825206756592, -0.5691190958023071, -0.4571417272090912, -0.3666524589061737, -0.3220129907131195, -0.3313034474849701, -0.38127419352531433, -0.44990190863609314, -0.5223277807235718, -0.5925766229629517, -0.6594007015228271, -0.7232067584991455, -0.7838900089263916, -0.8403773307800293, -0.8915117979049683, -0.9371147155761719, -0.978783369064331], [-0.9608165621757507, -0.9147345423698425, -0.8626974821090698, -0.799798846244812, -0.719491720199585, -0.6202425956726074, -0.5173685550689697, -0.43666741251945496, -0.3978818356990814, -0.4058017432689667, -0.4456709325313568, -0.5003794431686401, -0.5626932382583618, -0.630117654800415, -0.7003495693206787, -0.7708505392074585, -0.8386424779891968, -0.9005587100982666, -0.954858660697937, -1.0024484395980835, -1.046456217765808], [-1.0158039331436157, -0.9712592959403992, -0.9199897050857544, -0.858024537563324, -0.7805476784706116, -0.6884039044380188, -0.5977686643600464, -0.5308668613433838, -0.5002434253692627, -0.5050225257873535, -0.5320491790771484, -0.5721898078918457, -0.6245971918106079, -0.6892497539520264, -0.7625900506973267, -0.8382008075714111, -0.9095791578292847, -0.9723358154296875, -1.025613784790039, -1.0719778537750244, -1.1157742738723755]]
)

max_ind = np.unravel_index(np.argmax(value, axis=None), value.shape)
max_value = value[max_ind]
text = "max value={:.5f}, x={:.2f}, y={:.2f}".format(max_value, x[max_ind[0]], y[max_ind[1]])

fig = px.imshow(value,
                labels=dict(x="x", y="y", color="value"),
                x=x,
                y=y,
                text_auto=True,
                title=text)

fig.show()